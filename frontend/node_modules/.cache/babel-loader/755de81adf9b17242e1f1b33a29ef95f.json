{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar generators = require('@motionone/generators');\n\nfunction createGeneratorEasing(createGenerator) {\n  var keyframesCache = new WeakMap();\n  return function () {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var generatorCache = new Map();\n\n    var getGenerator = function getGenerator() {\n      var from = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var to = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;\n      var velocity = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var isScale = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n      var key = \"\".concat(from, \"-\").concat(to, \"-\").concat(velocity, \"-\").concat(isScale);\n\n      if (!generatorCache.has(key)) {\n        generatorCache.set(key, createGenerator(Object.assign({\n          from: from,\n          to: to,\n          velocity: velocity,\n          restSpeed: isScale ? 0.05 : 2,\n          restDistance: isScale ? 0.01 : 0.5\n        }, options)));\n      }\n\n      return generatorCache.get(key);\n    };\n\n    var getKeyframes = function getKeyframes(generator) {\n      if (!keyframesCache.has(generator)) {\n        keyframesCache.set(generator, generators.pregenerateKeyframes(generator));\n      }\n\n      return keyframesCache.get(generator);\n    };\n\n    return {\n      createAnimation: function createAnimation(keyframes, getOrigin, canUseGenerator, name, motionValue) {\n        var _a, _b;\n\n        var settings;\n        var numKeyframes = keyframes.length;\n        var shouldUseGenerator = canUseGenerator && numKeyframes <= 2 && keyframes.every(isNumberOrNull);\n\n        if (shouldUseGenerator) {\n          var target = keyframes[numKeyframes - 1];\n          var unresolvedOrigin = numKeyframes === 1 ? null : keyframes[0];\n          var velocity = 0;\n          var origin = 0;\n          var prevGenerator = motionValue === null || motionValue === void 0 ? void 0 : motionValue.generator;\n\n          if (prevGenerator) {\n            /**\n             * If we have a generator for this value we can use it to resolve\n             * the animations's current value and velocity.\n             */\n            var animation = motionValue.animation,\n                generatorStartTime = motionValue.generatorStartTime;\n            var startTime = (animation === null || animation === void 0 ? void 0 : animation.startTime) || generatorStartTime || 0;\n            var currentTime = (animation === null || animation === void 0 ? void 0 : animation.currentTime) || performance.now() - startTime;\n            var prevGeneratorCurrent = prevGenerator(currentTime).current;\n            origin = (_a = unresolvedOrigin) !== null && _a !== void 0 ? _a : prevGeneratorCurrent;\n\n            if (numKeyframes === 1 || numKeyframes === 2 && keyframes[0] === null) {\n              velocity = generators.calcGeneratorVelocity(function (t) {\n                return prevGenerator(t).current;\n              }, currentTime, prevGeneratorCurrent);\n            }\n          } else {\n            origin = (_b = unresolvedOrigin) !== null && _b !== void 0 ? _b : parseFloat(getOrigin());\n          }\n\n          var generator = getGenerator(origin, target, velocity, name === null || name === void 0 ? void 0 : name.includes(\"scale\"));\n          var keyframesMetadata = getKeyframes(generator);\n          settings = Object.assign(Object.assign({}, keyframesMetadata), {\n            easing: \"linear\"\n          }); // TODO Add test for this\n\n          if (motionValue) {\n            motionValue.generator = generator;\n            motionValue.generatorStartTime = performance.now();\n          }\n        } else {\n          var _keyframesMetadata = getKeyframes(getGenerator(0, 100));\n\n          settings = {\n            easing: \"ease\",\n            duration: _keyframesMetadata.overshootDuration\n          };\n        }\n\n        return settings;\n      }\n    };\n  };\n}\n\nvar isNumberOrNull = function isNumberOrNull(value) {\n  return typeof value !== \"string\";\n};\n\nexports.createGeneratorEasing = createGeneratorEasing;","map":null,"metadata":{},"sourceType":"script"}
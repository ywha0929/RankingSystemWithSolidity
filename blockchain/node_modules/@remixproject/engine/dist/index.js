!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pluginEngine=e():t.pluginEngine=e()}(global,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a=function(){function t(t){this.profile=t,this.activateService={},this.requestQueue=[],this.options={}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.profile.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"methods",{get:function(){return this.profile.methods},set:function(t){this.profile.methods=t},enumerable:!0,configurable:!0}),t.prototype.activate=function(){this.onActivation&&this.onActivation()},t.prototype.deactivate=function(){this.onDeactivation&&this.onDeactivation()},t.prototype.setOptions=function(t){void 0===t&&(t={}),this.options=r(r({},this.options),t)},t.prototype.callPluginMethod=function(t,e){var n=this.currentRequest&&this.currentRequest.path,r=s.getMethodPath(t,n);if(!(r in this))throw new Error("Method "+r+" is not implemented by "+this.profile.name);return this[r].apply(this,e)},t.prototype.addRequest=function(t,e,n){var r=this;return new Promise(function(s,a){r.requestQueue.push(function(){return i(r,void 0,void 0,function(){var r,i,u,c,l,f=this;return o(this,function(o){switch(o.label){case 0:this.currentRequest=t,r=!1,i=function(){r&&a("call to plugin has timed out "+f.profile.name+" - "+e+" - "+JSON.stringify(f.currentRequest)),delete f.currentRequest,f.requestQueue.shift(),0!==f.requestQueue.length&&f.requestQueue[0]()},u=setTimeout(function(){r=!0,i()},this.options.queueTimeout||1e4),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.callPluginMethod(e,n)];case 2:return c=o.sent(),r?[2]:(delete this.currentRequest,s(c),[3,4]);case 3:return l=o.sent(),a(l),[3,4];case 4:return clearTimeout(u),i(),[2]}})})}),1===r.requestQueue.length&&r.requestQueue[0]()})},t.prototype.askUserPermission=function(t,e){if(!this.currentRequest)return Promise.resolve(!0);if(this.methods.includes(t)){var n=this.currentRequest.from,r=this.name;return this.call("manager","canCall",n,r,t,e)}return Promise.resolve(!1)},t.prototype.createService=function(t,e){return i(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:if(this.methods&&this.methods.includes(t))throw new Error("A service cannot have the same name as an exposed method");return n=s.createService(t,e),[4,s.activateService(this,n)];case 1:return r.sent(),[2,n]}})})},t.prototype.prepareService=function(t,e){var n=this;return this.activateService[t]=function(){return i(n,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:if(this.methods&&this.methods.includes(t))throw new Error("A service cannot have the same name as an exposed method");return[4,e()];case 1:return n=i.sent(),r=s.createService(t,n),[4,s.activateService(this,r)];case 2:return i.sent(),delete this.activateService[t],[2,r]}})})}},t.prototype.on=function(t,e,n){throw new Error('Cannot use method "on" from plugin "'+this.name+'". It is not registered in the engine yet.')},t.prototype.once=function(t,e,n){throw new Error('Cannot use method "once" from plugin "'+this.name+'". It is not registered in the engine yet.')},t.prototype.off=function(t,e){throw new Error('Cannot use method "off" from plugin "'+this.name+'". It is not registered in the engine yet.')},t.prototype.call=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return i(this,void 0,void 0,function(){return o(this,function(t){throw new Error('Cannot use method "call" from plugin "'+this.name+'". It is not registered in the engine yet.')})})},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];throw new Error('Cannot use method "emit" from plugin "'+this.name+'". It is not registered in the engine yet.')},t}();e.Plugin=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(19))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(22))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(23))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(24))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(25))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(26))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(31))},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},u=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0});var c=n(0);function l(t){var n=t.url,r=t.name,i=Object.keys(e.defaultGateways).find(function(t){return n.startsWith(t)});return i?e.defaultGateways[i](n,r):n}e.defaultGateways={"ipfs://":function(t,e){return"https://"+e+".dyn.plugin.remixproject.org/ipfs/"+t.replace("ipfs://","")},"swarm://":function(t,e){return"https://swarm-gateways.net/bzz-raw://"+t.replace("swarm://","")}},e.transformUrl=l;var f=function(t){function e(e){var n=t.call(this,e)||this;return n.id=0,n.pendingRequest={},n.options={transformUrl:l},n}return i(e,t),e.prototype.deactivate=function(){this.loaded=!1,t.prototype.deactivate.call(this)},e.prototype.setOptions=function(e){void 0===e&&(e={}),t.prototype.setOptions.call(this,e)},e.prototype.callPluginMethod=function(t,e){var n=this;void 0===e&&(e=[]);var r=this.id++,i=this.currentRequest,o=this.name,s=new Promise(function(t,e){n.pendingRequest[r]=function(n,r){return r?e(r):t(n)}});return this.postMessage({id:r,action:"request",key:t,payload:e,requestInfo:i,name:o}),s},e.prototype.handshake=function(){return s(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return this.loaded?[3,2]:(this.loaded=!0,[4,this.callPluginMethod("handshake",[this.profile.name])]);case 1:t=e.sent(),this.call("manager","updateProfile",this.profile),t&&(this.profile.methods=t),e.label=2;case 2:return[2]}})})},e.prototype.getMessage=function(t){return s(this,void 0,void 0,function(){var e,n,r,i,s,c,l,f,h,p,d,v=this;return a(this,function(a){switch(a.label){case 0:if("request"===t.action&&"handshake"===t.key)return[2,this.handshake()];switch(t.action){case"on":case"listen":return[3,1];case"off":return[3,2];case"once":return[3,3];case"emit":case"notification":return[3,4];case"call":case"request":return[3,5];case"response":return[3,10]}return[3,11];case 1:return e=t.name,n=t.key,"notification",this.on(e,n,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return v.postMessage({action:"notification",name:e,key:n,payload:t})}),[3,12];case 2:return r=t.name,i=t.key,this.off(r,i),[3,12];case 3:return s=t.name,c=t.key,"notification",this.once(s,c,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return v.postMessage({action:"notification",name:s,key:c,payload:t})}),[3,12];case 4:return t.payload?(this.emit.apply(this,u([t.key],t.payload||[])),[3,12]):[3,12];case 5:l="response",a.label=6;case 6:return a.trys.push([6,8,,9]),[4,this.call.apply(this,u([t.name,t.key],t.payload||[]))];case 7:return p=a.sent(),d=void 0,this.postMessage(o(o({},t),{action:l,payload:p,error:d})),[3,9];case 8:return f=a.sent(),p=void 0,d=f.message||f,this.postMessage(o(o({},t),{action:l,payload:p,error:d})),[3,9];case 9:return[3,12];case 10:return h=t.id,p=t.payload,d=t.error,this.pendingRequest[h](p,d),delete this.pendingRequest[h],[3,12];case 11:throw new Error("Message should be a notification, request or response");case 12:return[2]}})})},e}(c.Plugin);e.ExternalPlugin=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(27))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(28))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(29))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(30))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getMethodPath=function(t,e){if(!e)return t;var n=e.split(".");return n.shift(),n.push(t),n.join(".")},e.getRootPath=function(t){return t.split(".").shift()}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0});var a=n(13),u=function(){function t(){}return t.prototype.emit=function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(e=this.plugin).emit.apply(e,s([t],n))},t.prototype.createService=function(t,e){return i(this,void 0,void 0,function(){var n,r;return o(this,function(i){switch(i.label){case 0:if(this.methods.includes(t))throw new Error("A service cannot have the same name as an exposed method");return n=this.path+"."+t,r=l(n,e),[4,f(this.plugin,r)];case 1:return i.sent(),[2,r]}})})},t.prototype.prepareService=function(t,e){var n=this;if(this.methods.includes(t))throw new Error("A service cannot have the same name as an exposed method");var r=this.path+"."+t;this.plugin.activateService[r]=function(){return i(n,void 0,void 0,function(){var t,n;return o(this,function(i){switch(i.label){case 0:return t=e(),n=l(r,t),[4,f(this.plugin,n)];case 1:return i.sent(),delete this.plugin.activateService[r],[2,n]}})})}},t}();function c(t){if(t.methods){for(var n=0,r=t.methods;n<r.length;n++){var i=r[n];if(!(i in t))throw new Error("Method "+i+" is not part of serivce")}return t.methods}if(e.isPluginService(t)){var o=Object.getPrototypeOf(t);return Object.getOwnPropertyNames(o).filter(function(t){return"constructor"!==t&&!t.startsWith("_")})}return Object.getOwnPropertyNames(t).filter(function(e){return"function"==typeof t[e]&&!e.startsWith("_")})}function l(t,n){if(n.path&&a.getRootPath(n.path)!==t)throw new Error("Service path "+n.path+" is different from the one provided: "+t);for(var i=c(n),o=0,s=i;o<s.length;o++){var u=s[o];if(!(u in n))throw new Error("Method "+u+" is not part of service "+t)}return e.isPluginService(n)?(n.methods||(n.methods=i),n):r(r({},n),{methods:i,path:t})}function f(t,e){t.methods=s(t.methods||[],e.methods);for(var n=0,r=c(e);n<r.length;n++){var i=r[n];t[e.path+"."+i]=e[i].bind(e)}return t.call("manager","updateProfile",{methods:t.methods})}e.PluginService=u,e.isPluginService=function(t){return t instanceof u},e.getMethods=c,e.createService=l,e.activateService=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(16))},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(17)),r(n(39)),r(n(14))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(18))},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a=function(){function t(t){var e=this;this.manager=t,this.plugins={},this.events={},this.listeners={},this.isLoaded=!1,this.plugins.manager=t,this.manager.engineActivatePlugin=function(t){return e.activatePlugin(t)},this.manager.engineDeactivatePlugin=function(t){return e.deactivatePlugin(t)},t.activatePlugin("manager").then(function(){e.isLoaded=!0,e.managerLoaded&&e.managerLoaded()})}return t.prototype.onload=function(t){return r(this,void 0,void 0,function(){var e=this;return i(this,function(n){return[2,new Promise(function(n,r){e.isLoaded?(n(),t&&t()):e.managerLoaded=function(){n(),t&&t(),delete e.managerLoaded}})]})})},t.prototype.broadcast=function(t,e){for(var n=this,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=s.listenEvent(t,e);this.listeners[o]&&(this.listeners[o]||[]).forEach(function(i){var s;if(!n.events[i][o])throw new Error("Plugin "+i+" should be listening on event "+e+" from "+t+". But no callback have been found");(s=n.events[i])[o].apply(s,r)})},t.prototype.addListener=function(t,e,n,r){var i=s.listenEvent(e,n);this.events[t][i]||(this.events[t][i]=r),this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].includes(t)||this.listeners[i].push(t)},t.prototype.removeListener=function(t,e,n){var r=s.listenEvent(e,n);this.listeners[r]=this.listeners[r].filter(function(e){return e!==t}),delete this.events[t][r]},t.prototype.listenOnce=function(t,e,n,r){var i=this;this.addListener(t,e,n,function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];r.apply(void 0,o),i.removeListener(t,e,n)})},t.prototype.callMethod=function(t,e,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r(this,void 0,void 0,function(){var r,s,a,u,c,l,f;return i(this,function(i){switch(i.label){case 0:if(r=e.split(".").shift(),!this.plugins[r])throw new Error("Cannot call "+r+" from "+t+", because "+r+" is not registered");return[4,Promise.all([this.manager.getProfile(r),this.manager.getProfile(t)])];case 1:return s=i.sent(),a=s[0],u=s[1],[4,this.manager.isActive(r)];case 2:return i.sent()?[3,6]:[4,this.manager.canActivate(u,a)];case 3:return i.sent()?[4,this.manager.toggleActive(r)]:[3,5];case 4:return i.sent(),[3,6];case 5:throw new Error(u.name+" cannot call "+n+" of "+r+", because "+r+" is not activated yet");case 6:if(!a.methods.includes(n))throw c='Cannot call method "'+n+'" of "'+r+'" from "'+t+'", because "'+n+'" is not exposed.',l="Here is the list of exposed methods: "+a.methods.map(function(t){return'"'+t+'"'}).join(","),new Error(c+" "+l);return f={from:t,path:e},[2,this.plugins[r].addRequest(f,n,o)]}})})},t.prototype.createApp=function(t){return r(this,void 0,void 0,function(){var e,n=this;return i(this,function(r){switch(r.label){case 0:return e=Object.keys(this.plugins).map(function(t){return n.manager.getProfile(t)}),[4,Promise.all(e)];case 1:return[2,r.sent().reduce(function(e,r){return e[r.name]=(r.methods||[]).reduce(function(e,i){return e[i]=function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];return n.callMethod.apply(n,o([t,r.name,i],e))},e},{on:function(e,i){return n.addListener(t,r.name,e,i)},once:function(e,i){return n.listenOnce(t,r.name,e,i)},off:function(e){return n.removeListener(t,r.name,e)},profile:r}),e},{})]}})})},t.prototype.activatePlugin=function(t){return r(this,void 0,void 0,function(){var e,n,r,s=this;return i(this,function(i){switch(i.label){case 0:if(!this.plugins[t])throw new Error("Cannot active plugin "+t+" because it's not registered yet");return[4,this.manager.isActive(t)];case 1:return i.sent()?[2]:(e=this.plugins[t],this.events[t]={},e.on=function(e,n,r){s.addListener(t,e,n,r)},e.once=function(e,n,r){s.listenOnce(t,e,n,r)},e.off=function(e,n){s.removeListener(t,e,n)},e.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];s.broadcast.apply(s,o([t,e],n))},e.call=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return s.callMethod.apply(s,o([t,e,n],r))},n=e,r="app",[4,this.createApp(t)]);case 2:return n[r]=i.sent(),e.createApp=function(){return s.createApp(t)},[4,e.activate()];case 3:return i.sent(),[2]}})})},t.prototype.deactivatePlugin=function(t){return r(this,void 0,void 0,function(){var e,n=this;return i(this,function(r){switch(r.label){case 0:if(!this.plugins[t])throw new Error("Cannot deactive plugin "+t+" because it's not registered yet");return[4,this.manager.isActive(t)];case 1:return r.sent()?[4,(e=this.plugins[t]).deactivate()]:[2];case 2:return r.sent(),this.updateErrorHandler(e),delete e.app,delete e.createApp,delete this.events[t],Object.keys(this.listeners).forEach(function(e){n.listeners[e].forEach(function(r,i){r===t&&n.listeners[e].splice(i,1)})}),[2]}})})},t.prototype.updateErrorHandler=function(t){var e=function(t){return"Plugin "+name+" is currently deactivated. "+t+". Activate "+name+" first."};t.call=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];throw new Error(e("It cannot call method "+n+" of plugin "+t+"."))},t.on=function(t,n){throw new Error(e("It cannot listen on event "+n+" of plugin "+t+"."))},t.once=function(t,n){throw new Error(e("It cannot listen on event "+n+" of plugin "+t+"."))},t.off=function(t,n){throw new Error(e("All event listeners are already removed."))},t.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];throw new Error(e("It cannot emit the event "+t))}},t.prototype.register=function(t){var e=this,n=function(t){if(e.plugins[t.name])throw new Error("Plugin "+t.name+" is already register.");if(e.plugins[t.name]=t,e.manager.addProfile(t.profile),e.updateErrorHandler(t),e.setPluginOption){var n=e.setPluginOption(t.profile);t.setOptions(n)}return t.onRegistration&&t.onRegistration(),e.onRegistration&&e.onRegistration(t),t.name};return Array.isArray(t)?t.map(function(t){return n(t)}):n(t)},t.prototype.isRegistered=function(t){return!!this.plugins[t]},t}();e.Engine=a},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(20)),r(n(21)),r(n(36)),r(n(13)),r(n(14))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.callEvent=function(t,e,n){return"["+t+"] "+e+"-"+n},e.listenEvent=function(t,e){return"["+t+"] "+e}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(2)),r(n(3)),r(n(4)),r(n(5)),r(n(6)),r(n(9)),r(n(10)),r(n(11)),r(n(12)),r(n(7)),r(n(32)),r(n(35))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compilerProfile={name:"compiler",methods:["compile","getCompilationResult"],events:["compilationFinished"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.editorProfile={name:"editor",methods:["discardHighlight","highlight"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.filSystemProfile={name:"fs",methods:["getCurrentFile","getFile","getFolder","setFile","switchFile"],events:["currentFileChanged"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.networkProfile={name:"network",methods:["addNetwork","detectNetwork","getEndpoint","getNetworkProvider","removeNetwork"],events:["providerChanged"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.udappProfile={name:"udapp",methods:["createVMAccount","getAccounts","sendTransaction"],events:["newTransaction"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.themeProfile={name:"theme",methods:[],events:["themeChanged"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unitTestProfile={name:"unitTest",methods:["testFromPath","testFromSource"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.contentImportProfile={name:"contentImport",methods:["resolve"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.settingsProfile={name:"settings",methods:["getGithubAccessToken"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pluginManagerProfile={name:"manager",methods:["getProfile","updateProfile","activatePlugin","deactivatePlugin","canCall"]}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(4),s=n(3),a=n(5),u=n(6),c=n(9),l=n(10),f=n(11),h=n(12),p=n(33),d=n(7);e.remixApi=Object.freeze({manager:d.pluginManagerProfile,solidity:r(r({},i.compilerProfile),{name:"solidity"}),fileManager:r(r({},o.filSystemProfile),{name:"fileManager"}),solidityUnitTesting:r(r({},l.unitTestProfile),{name:"solidityUnitTesting"}),editor:s.editorProfile,network:a.networkProfile,udapp:u.udappProfile,contentImport:f.contentImportProfile,settings:h.settingsProfile,theme:c.themeProfile}),e.remixProfiles=Object.freeze({manager:d.pluginManagerProfile,solidity:r(r({},i.compilerProfile),{name:"solidity"}),fileManager:r(r({},o.filSystemProfile),{name:"fileManager"}),git:r(r({},p.gitProfile),{name:"git"}),solidityUnitTesting:r(r({},l.unitTestProfile),{name:"solidityUnitTesting"}),editor:s.editorProfile,network:a.networkProfile,udapp:u.udappProfile,contentImport:f.contentImportProfile,settings:h.settingsProfile,theme:c.themeProfile})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(34))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.gitProfile={name:"remixd.git",methods:["clone","checkout","init","add","commit","fetch","pull","push","reset","status","remote","log"]}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(4),s=n(3),a=n(5),u=n(6),c=n(7);e.standardProfiles=Object.freeze({manager:c.pluginManagerProfile,solidity:r(r({},i.compilerProfile),{name:"solidity"}),fileManager:r(r({},o.filSystemProfile),{name:"fileManager"}),editor:s.editorProfile,network:a.networkProfile,udapp:u.udappProfile})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(37))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(38))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.boxProfile={name:"box",methods:["login","isEnabled","getUserAddress","openSpace","closeSpace","isSpaceOpened","getSpacePrivateValue","setSpacePrivateValue","getSpacePublicValue","setSpacePublicValue","getSpacePublicData","getSpaceName"],events:["enabled","loggedIn","loggedOut","spaceClosed","spaceOpened"]}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(0)),r(n(40)),r(n(41)),r(n(42)),r(n(43)),r(n(44)),r(n(45)),r(n(46))},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=Array.from(new Set(s(e.methods||[],["currentFocus","focus","addView","removeView"])));return t.call(this,o(o({},e),{methods:n}))||this}return i(e,t),e}(n(0).Plugin);e.HostPlugin=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e){var n=t.call(this,e)||this;return n.profile=e,n.listener=["message",function(t){return n.getEvent(t)},!1],n.iframe=document.createElement("iframe"),n}return i(e,t),e.prototype.activate=function(){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.call(this.profile.location,"addView",this.profile,this.render())];case 1:return e.sent(),t.prototype.activate.call(this),[2]}})})},e.prototype.deactivate=function(){this.iframe.remove(),window.removeEventListener.apply(window,this.listener),this.call(this.profile.location,"removeView",this.profile),t.prototype.deactivate.call(this)},e.prototype.getEvent=function(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return t.source!==this.source?[2]:t.origin!==this.origin?[2]:(e=t.data,this.getMessage(e),[2])})})},e.prototype.postMessage=function(t){if(!this.source)throw new Error("No window attached to Iframe yet");this.source.postMessage(t,this.origin)},e.prototype.render=function(){var t=this;if(this.iframe.contentWindow)throw new Error(this.name+" plugin is already rendered");return this.iframe.setAttribute("sandbox","allow-popups allow-scripts allow-same-origin allow-forms allow-top-navigation"),this.iframe.setAttribute("seamless","true"),this.iframe.setAttribute("id","plugin-"+this.name),this.iframe.src=this.options.transformUrl?this.options.transformUrl(this.profile):this.profile.url,this.iframe.onload=function(){return o(t,void 0,void 0,function(){return s(this,function(t){if(!this.iframe.contentWindow)throw new Error(this.name+" plugin is cannot find url "+this.profile.url);return this.origin=new URL(this.iframe.src).origin,this.source=this.iframe.contentWindow,window.addEventListener.apply(window,this.listener),this.handshake(),[2]})})},this.iframe},e}(n(8).ExternalPlugin);e.IframePlugin=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0});var u=n(0);function c(t){return!!t.location}e.isViewLibrary=c;var l=function(t){function e(e,n){var r=t.call(this,n)||this;if(r.library=e,r.profile=n,n.methods.forEach(function(t){if(!e[t])throw new Error("Method "+t+" is exposed by LibraryPlugin "+n.name+". But library doesn't expose this method")}),r.isView=c(n),r.isView&&!r.render)throw new Error("Profile "+n.name+" define the location "+n.location+', but method "render" is not implemented');return r}return i(e,t),e.prototype.activate=function(){return o(this,void 0,void 0,function(){var e=this;return s(this,function(n){switch(n.label){case 0:return this.isView?[4,this.call(this.profile.location,"addView",this.profile,this.render())]:[3,2];case 1:n.sent(),n.label=2;case 2:if(t.prototype.activate.call(this),this.profile.notifications){if(!this.library.events||!this.library.events.emit)throw new Error('"events" object from Library of plugin '+this.name+' should implement "emit"');Object.keys(this.profile.notifications).forEach(function(t){e.profile.notifications[t].forEach(function(n){e.on(t,n,function(r){var i;return(i=e.library.events).emit.apply(i,a(["["+t+"] "+n],r))})})})}if(this.profile.events){if(!this.library.events||!this.library.events.emit)throw new Error('"events" object from Library of plugin '+this.name+' should implement "emit"');this.profile.events.forEach(function(t){e.library.events.on(t,function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.emit.apply(e,a([t],n))})})}return[2]}})})},e.prototype.deactivate=function(){var e=this;this.isView&&this.call(this.profile.location,"removeView",this.profile),this.profile.notifications&&Object.keys(this.profile.notifications).forEach(function(t){e.profile.notifications[t].forEach(function(n){return e.off(t,n)})}),this.profile.events&&this.library.events.off&&this.profile.events.forEach(function(t){return e.library.events.off(t)}),t.prototype.deactivate.call(this)},e.prototype.callPluginMethod=function(t,e){var n;if(!this.library[t])throw new Error("LibraryPlugin "+this.name+" doesn't expose method "+t);return(n=this.library)[t].apply(n,e)},e}(u.Plugin);e.LibraryPlugin=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(0);e.isView=function(t){return!!t.location};var u=function(t){function e(e){var n=t.call(this,e)||this;return n.profile=e,n}return i(e,t),e.prototype.activate=function(){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.call(this.profile.location,"addView",this.profile,this.render())];case 1:return e.sent(),t.prototype.activate.call(this),[2]}})})},e.prototype.deactivate=function(){this.call(this.profile.location,"removeView",this.profile),t.prototype.deactivate.call(this)},e}(a.Plugin);e.ViewPlugin=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(8),u=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e)||this;return r.profile=e,r.listener=["message",function(t){return r.getEvent(t)},!1],r.reconnectOnclose=["close",function(){return r.reconnect()},!1],r.options={transformUrl:a.transformUrl,reconnectDelay:1e3},r.setOptions(n),r}return i(e,t),e.prototype.activate=function(){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return this.connect(),(e=this.socket).addEventListener.apply(e,this.reconnectOnclose),t.prototype.activate.call(this),[2]})})},e.prototype.deactivate=function(){var e,n;(e=this.socket).removeEventListener.apply(e,this.reconnectOnclose),(n=this.socket).removeEventListener.apply(n,this.listener),this.socket.close(),t.prototype.deactivate.call(this)},e.prototype.setOptions=function(e){void 0===e&&(e={}),t.prototype.setOptions.call(this,e)},e.prototype.reconnect=function(){var t=this;this.loaded=!1,setTimeout(function(){return t.connect()},this.options.reconnectDelay)},e.prototype.connect=function(){var t=this,e=this.options.transformUrl?this.options.transformUrl(this.profile):this.profile.url;this.socket=new WebSocket(e),this.socket.addEventListener("open",function(){return o(t,void 0,void 0,function(){var t;return s(this,function(e){return(t=this.socket).addEventListener.apply(t,this.listener),this.handshake(),[2]})})})},e.prototype.getEvent=function(t){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return e=JSON.parse(t.data),this.getMessage(e),[2]})})},e.prototype.postMessage=function(t){if(this.socket.readyState!==this.socket.OPEN)throw new Error("Websocket connection is not open yet");this.socket.send(JSON.stringify(t))},e}(a.ExternalPlugin);e.WebsocketPlugin=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),c=n(0);e.managerMethods=["getProfile","updateProfile","activatePlugin","deactivatePlugin","isActive","canCall"];var l=function(t){function n(n){void 0===n&&(n=u.pluginManagerProfile);var r=t.call(this,n)||this;return r.profiles={},r.actives=[],r.methods=e.managerMethods,r.profiles[n.name]=n,r}return i(n,t),Object.defineProperty(n.prototype,"requestFrom",{get:function(){return this.currentRequest?this.currentRequest.from:"manager"},enumerable:!0,configurable:!0}),n.prototype.getProfile=function(t){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.profiles[t]]})})},n.prototype.updateProfile=function(t){if(t){if(t.name&&t.name!==this.requestFrom)throw new Error("A plugin cannot change its name.");var e=this.requestFrom;if(!this.profiles[e])throw new Error("Plugin "+e+" is not register, you cannot update it's profile.");if(t.url&&t.url!==this.profiles[e].url)throw new Error("Url from Profile cannot be updated.");this.profiles[e]=o(o({},this.profiles[e]),t),this.emit("profileUpdated",this.profiles[e])}},n.prototype.addProfile=function(t){if(this.profiles[t.name])throw new Error("Plugin "+t.name+" already exist");this.profiles[t.name]=t,this.emit("profileAdded",t),this.onProfileAdded&&this.onProfileAdded(t)},n.prototype.isActive=function(t){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,this.actives.includes(t)]})})},n.prototype.activatePlugin=function(t){return s(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){return e=function(t){return s(n,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:return[4,this.isActive(t)];case 1:return i.sent()?[2]:[4,Promise.all([this.getProfile(t),this.getProfile(this.requestFrom)])];case 2:return e=i.sent(),n=e[0],r=e[1],[4,this.canActivate(r,n)];case 3:return i.sent()?[4,this.toggleActive(t)]:[3,5];case 4:return i.sent(),[3,6];case 5:throw new Error("Plugin "+this.requestFrom+" has no right to activate plugin "+t);case 6:return[2]}})})},[2,Array.isArray(t)?Promise.all(t.map(e)):e(t)]})})},n.prototype.deactivatePlugin=function(t){return s(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){return e=function(t){return s(n,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:return[4,this.isActive(t)];case 1:return i.sent()?[4,Promise.all([this.getProfile(t),this.getProfile(this.requestFrom)])]:[2];case 2:return e=i.sent(),n=e[0],r=e[1],[4,this.canDeactivate(r,n)];case 3:return i.sent()?[4,this.toggleActive(t)]:[3,5];case 4:return i.sent(),[3,6];case 5:throw new Error("Plugin "+this.requestFrom+" has no right to deactivate plugin "+t);case 6:return[2]}})})},[2,Array.isArray(t)?Promise.all(t.map(e)):e(t)]})})},n.prototype.toggleActive=function(t){return s(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){return e=function(t){return s(n,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:return[4,Promise.all([this.isActive(t),this.getProfile(t)])];case 1:return e=i.sent(),n=e[0],r=e[1],n?[4,this.engineDeactivatePlugin(t)]:[3,3];case 2:return i.sent(),this.actives=this.actives.filter(function(e){return e!==t}),this.emit("pluginDeactivated",r),this.onPluginDeactivated&&this.onPluginDeactivated(r),[3,5];case 3:return[4,this.engineActivatePlugin(t)];case 4:i.sent(),this.actives.push(t),this.emit("pluginActivated",r),this.onPluginActivated&&this.onPluginActivated(r),i.label=5;case 5:return[2]}})})},[2,Array.isArray(t)?Promise.all(t.map(e)):e(t)]})})},n.prototype.canActivate=function(t,e){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,!0]})})},n.prototype.canDeactivate=function(t,e){return s(this,void 0,void 0,function(){return a(this,function(e){return"manager"===t.name?[2,!0]:[2,!1]})})},n.prototype.canCall=function(t,e,n,r){return s(this,void 0,void 0,function(){return a(this,function(t){return[2,!0]})})},n}(c.Plugin);e.PluginManager=l},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(8),u=n(47),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listener=["message",function(t){return e.getMessage(t)}],e}return i(e,t),e.prototype.activate=function(){return o(this,void 0,void 0,function(){var e;return s(this,function(n){return this.process=u.fork(this.profile.url),(e=this.process).on.apply(e,this.listener),t.prototype.activate.call(this),[2]})})},e.prototype.deactivate=function(){var e;(e=this.process).off.apply(e,this.listener),this.process.disconnect(),this.process.kill(),t.prototype.deactivate.call(this)},e.prototype.postMessage=function(t){var e;if(!(null===(e=this.process)||void 0===e?void 0:e.connected))throw new Error('Child process from plugin "'+this.name+'" is not yet connected');this.process.send(t)},e}(a.ExternalPlugin);e.ChildProcessPlugin=c},function(t,e){t.exports=require("child_process")}])});